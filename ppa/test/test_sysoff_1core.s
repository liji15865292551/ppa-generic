// 
// ARM v8 AArch64 PSCI test code
//
// Copyright (c) 2017, NXP Semiconductors, Inc. All rights reserved.
//

// This includes:
// (1) PSCI test code (executes @ EL2)

//-----------------------------------------------------------------------------

  .section .text, "ax"
 
//-----------------------------------------------------------------------------
    
#include "soc.h"
#include "psci.h"

//-----------------------------------------------------------------------------

  .global _test_psci

//-----------------------------------------------------------------------------

.align 12

//-----------------------------------------------------------------------------

.ltorg

//-----------------------------------------------------------------------------

_test_psci:

 //------------------------------------

     // test SYSTEM_OFF (core 0)
     // x0 = function id = PSCI_SYSTEM_OFF = 0x84000008
    dsb sy
    isb
    nop
    ldr  x0, =PSCI_SYSTEM_OFF
    smc  0x0
    nop
    nop
core_0_fail:
    b     core_0_fail

 //------------------------------------

